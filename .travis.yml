sudo: enabled
env:
  global:
    # include $HOME/.local/bin for `aws`
    - PATH=$HOME/.local/bin:$PATH

before_install:
  - pip install --user awscli
  - mkdir -p ~/$TRAVIS_BUILD_NUMBER

stages:
  - compile
  - test

jobs:
  include:

    #
    # Compile
    #

    - stage: compile
      script:
        - MIX_ENV=test make deps compile
    - stage: compile
      script:
        - MIX_ENV=prod make deps compile

    #
    # Test
    #

    - stage: test
      script:
        - make test
    - stage: test
      script:
        - make lint